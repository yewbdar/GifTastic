<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ"
        crossorigin="anonymous">
    <style>
    </style>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-lg-12 " id="button-holder"></div>
        </div>
        <div class="row mt-3">
            <div class="col-lg-8 ">
                <div id="gif-image-view"></div>
            </div>
            <div class="col-lg-4 ">
                <label>Add Topic</label>
                <input type="text" id="topic" />
                <input class="ml-2" type="submit" id="add" value="Add"><br/>
                <p id="info" class="ml-5"></p>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">

        var gifImage = {
            APIKey: "IBh0Q9Yv3uGFbrSGFBma1UCLfOUBOEl7",
            topics: ["cat", "dog", "bird","hello","goodbye","sweet","baby","apple","dance","morning","bad","up","lol","cute"],
            isImageClick: 0,
            copeOfResponse: 0,
            selectedGifType: null,
            //creat and display each image 
            displayGifImages: function (x) {

                if (this.isImageClick === 0) {
                    $("#gif-image-view").empty();
                    for (var i = 0; i < x.length; i++) {
                        var p=$("<h6>");
                        var image = $("<img>");

                          p.text( "Rating : "+x[i].rating);
                        p.css({"float":"left"});
                        image.append(p);
                        image.addClass("gif-image");
                        image.attr("id", x[i].id)
                        image.css({ "width": "200", "height": "200", "margin": "0.5%","float":"left" })
                        image.attr("src", x[i].images["480w_still"].url);
                        $("#gif-image-view").append(p);
                        $("#gif-image-view").append(image);


                    }
                }

            },
            creatButton: function () {
                $("#button-holder").empty();
                for (var i = 0; i < this.topics.length; i++) {

                    var butn = $("<button>");
                    butn.addClass("gif-button");
                    butn.attr("gif", this.topics[i]);
                    butn.css({ "width": "70", "height": "30", "margin": "0.5%" ,"background-color":"rgb(110, 210, 210)"})

                    butn.text(this.topics[i]);
                    $("#button-holder").append(butn);
                }

            },


        }

        function loadApi(topic) {
            var url = "http://api.giphy.com/v1/gifs/search?q=" + topic + "&api_key=" + gifImage.APIKey + "&limit=10";
            $.ajax({ url: url, method: "GET" }).then(function (response) {
                debugger;

                gifImage.copeOfResponse = response.data;
                gifImage.displayGifImages(gifImage.copeOfResponse)
                // map(item =>{item.url}));
                console.log(response.data);

            })
        }

        $(document).on('click', ".gif-button", function () {
            debugger;
            gifImage.selectedGifType = $(this).attr("gif");
            loadApi(gifImage.selectedGifType);
        });
        $(document).on('click', ".gif-image", function () {
            debugger;
            var idOfImage = $(this).attr("id");
            if (gifImage.isImageClick === 0) {

                for (var i = 0; i < gifImage.copeOfResponse.length; i++) {
                    if (gifImage.copeOfResponse[i].id === idOfImage) {

                        $("#" + idOfImage).prop("src", gifImage.copeOfResponse[i].images.downsized.url);

                    }
                }
                gifImage.isImageClick = 1;
            }
            else if (gifImage.isImageClick === 1) {
                for (var i = 0; i < gifImage.copeOfResponse.length; i++) {
                    if (gifImage.copeOfResponse[i].id === idOfImage) {

                        $("#" + idOfImage).prop("src", gifImage.copeOfResponse[i].images["480w_still"].url);

                    }
                }
                gifImage.isImageClick = 0;
            }
        });
       
            $(document).on("mouseenter",".gif-button",function () { $(this).css("background-color", "rgba(110, 210, 210, 0.6)") })
            $(document).on("mouseleave",".gif-button",function () { $(this).css("background-color", "rgb(110, 210, 210)") })

          
        gifImage.creatButton();
        $("#add").on('click', function () {
            debugger
            var value = $("#topic").val();
            if (value !== ""){
                gifImage.topics.push(value);
            gifImage.creatButton();
            $("#topic").val("")
            }
            else{
                $("#info").text("Please insert the topic")
                $("#info").css("color","red")
            }
        });
        $("#topic").keyup(function(){
        debugger;
        
        $("#info").text(" ");
        
        });
    </script>


</body>

</html>